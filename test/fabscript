# -*- python -*-
#
# Copyright (c) 2017 Stefan Seefeld
# All rights reserved.
#
# Distributed under the Boost Software License, Version 1.0.
# (See accompanying file LICENSE_1_0.txt or copy at
# http://www.boost.org/LICENSE_1_0.txt)

from faber import platform
from faber.feature import set
from faber.tools.compiler import define, libs
from faber.artefacts.binary import binary
from faber.test import test, report, fail

test_features = set(define('BOOST_GIL_NO_IO'), libs('boost_filesystem'))

def gil_test(name, sources, features):
    return test(name, binary(name, sources, features=features))


tests = [gil_test('image',
                  ['image.cpp', 'sample_image.cpp', 'error_if.cpp'],
                  features=test_features),
         gil_test('channel', ['channel.cpp', 'error_if.cpp'],
                  features=test_features),
         gil_test('pixel', ['pixel.cpp', 'error_if.cpp'],
                  features=test_features),
         gil_test('pixel_iterator', ['pixel_iterator.cpp', 'error_if.cpp'],
                  features=test_features)]


default = report('report', tests, fail_on_failures=True)
